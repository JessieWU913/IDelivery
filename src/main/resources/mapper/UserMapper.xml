<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="cs.qqq.Mapper.UserMapper">


    <insert id="saveUser">
    insert into sys_user
    <trim prefix="(" suffix=")" suffixOverrides=",">
        <if test="userName != null and userName != ''">user_name,</if>
        <if test="password != null and password != ''">password,</if>
        <if test="roleId != null">role_id,</if>
        <if test="phonenumber != null">phonenumber,</if>
        <if test="pic != null">pic,</if>
        <if test="email != null">email,</if>
        <if test="remark != null">remark,</if>
        <if test="createBy != null">create_by,</if>
        <if test="createTime != null">create_time,</if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
    <if test="userName != null and userName != ''">#{userName},</if>
    <if test="password != null and password != ''">#{password},</if>
    <if test="roleId != null">#{roleId},</if>
    <if test="phonenumber != null">#{phonenumber},</if>
    <if test="pic != null">#{pic},</if>
    <if test="email != null">#{email},</if>
    <if test="remark != null">#{remark},</if>
    <if test="createBy != null">#{createBy},</if>
    <if test="createTime != null">#{createTime},</if>
    </trim>
    </insert>


    <update id="updateUser">
        update sys_user set status=#{status} where user_id=#{userId}
    </update>
    <update id="updateUser1">
        update sys_user set role_id=#{roleId},user_name=#{userName},email=#{email},phonenumber=#{phonenumber},password=#{password},update_by=#{updateBy},update_time=#{updateTime},remark=#{remark},pic=#{pic}
        where user_id=#{userId}
    </update>


    <select id="getAllUsers" resultType="cs.qqq.Entity.SysUser">
           select  * from sys_user,sys_role where sys_user.role_id=sys_role.role_id
    </select>

    <delete id="deleteUserByID">
        delete
        from sys_user
        where user_id = #{id}
    </delete>
    <select id="findUserByUsernameAndPassword" resultType="cs.qqq.Entity.SysUser">
        select * from sys_user where user_name=#{userName} and password=#{password}
    </select>
    <select id="findUserById" resultType="cs.qqq.Entity.SysUser">
        select * from sys_user where user_id=#{userId}
    </select>
    <select id="findAllUsers" resultType="cs.qqq.Entity.SysUser">
        SELECT *
        FROM sys_user u
        JOIN sys_role r ON u.role_id = r.role_id
        WHERE r.role_id = #{roleId}
        <if test="userName != null and userName!=''">
            AND u.user_name LIKE CONCAT('%',#{userName},'%')
        </if>
        <if test="phonenumber != null and phonenumber !=''">
            AND u.phonenumber = #{phonenumber}
        </if>
        <if test="beginTime != null and beginTime !=''   ">
            AND u.create_time &gt;= #{beginTime}
        </if>
        <if test="endTime != null and beginTime !='' ">
            AND u.create_time &lt;= #{endTime}
        </if>
    </select>
</mapper>